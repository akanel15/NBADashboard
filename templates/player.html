{% extends 'base.html' %}

{% block head %}
<script type=text/javascript src="{{url_for('static', filename='player.js') }}"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.5.1/chart.min.js"></script>
{% endblock %}

{% block content %}
<!-- Player Banner -->
<section class="hero is-primary">
  <div class="hero-body">
    <p class="title">
      Stephen Curry
    </p>
    <p class="subtitle">
      Golden State Warriors
    </p>
  </div>
</section>

<!-- Search bar on left -->
<section class="section is-small">
  <nav class="level">
    <div class="level-left"></div>
    <div class="level-right">
      <div class="level-item">

        <!-- Search text field -->
        <div class="field has-addons">
          <div class="control">
            <input class="input" type="text" placeholder="Player name" value="Stephen Curry">
          </div>
          <div class="control">
            <a class="button is-info">
              Search
            </a>
          </div>
        </div>
  
      </div>
    </div>
  </nav>
</section>

<section class="section">
  <div class="container">

    <div class="tile is-ancestor">
      <div class="tile is-vertical is-parent">
        <div class="tile is-parent">
          <!-- Tile 1 -->
          <div class="tile is-child box">

            <!-- Player stats table -->
            <table class="table">
              <thead>
                <tr>
                  <th>By Year</th>
                  <th>Team</th>
                  <th><abbr title="Games Played">GP</abbr></th>
                  <th><abbr title="Minutes Played">MIN</abbr></th>
                  <th><abbr title="Points">PTS</abbr></th>
                  <th><abbr title="Field Goals Made">FGM</abbr></th>
                  <th><abbr title="Field Goals Attempted">FGA</abbr></th>
                </tr>
              </thead>
              <tfoot>
                <tr>
                  <th>By Year</th>
                  <th>Team</th>
                  <th><abbr title="Games Played">GP</abbr></th>
                  <th><abbr title="Minutes Played">MIN</abbr></th>
                  <th><abbr title="Points">PTS</abbr></th>
                  <th><abbr title="Field Goals Made">FGM</abbr></th>
                  <th><abbr title="Field Goals Attempted">FGA</abbr></th>
                </tr>
              </tfoot>
              <tbody>
                <tr>
                  <th>2020-21</th>
                  <td><a href="https://www.nba.com/stats/team/1610612744/"><abbr
                        title="Golden State Warriors">GSW</abbr></a></td>
                  <td>63</td>
                  <td>34.2</td>
                  <td>32.0</td>
                  <td>10.4</td>
                  <td>21.7</td>
                </tr>
                <tr>
                  <th>2019-20</th>
                  <td><a href="https://www.nba.com/stats/team/1610612744/"><abbr
                        title="Golden State Warriors">GSW</abbr></a></td>
                  <td>5</td>
                  <td>27.9</td>
                  <td>20.8</td>
                  <td>6.6</td>
                  <td>16.4</td>
                </tr>
                <tr>
                  <th>2018-19</th>
                  <td><a href="https://www.nba.com/stats/team/1610612744/"><abbr
                        title="Golden State Warriors">GSW</abbr></a></td>
                  <td>69</td>
                  <td>33.8</td>
                  <td>27.3</td>
                  <td>9.2</td>
                  <td>19.4</td>
                </tr>
              </tbody>
            </table>

          </div>
          <!-- Tile 2 -->
          <div class="tile is-child box">

            <p class="title">This is where rankings go</p>

          </div>

        </div>
        <div class="tile is-parent">
          <!-- Tile 3 -->
          <div class="tile is-child box">

            <!-- Performance Chart -->
            <div class="chartArea">
              <canvas id="myChart"></canvas>
            </div>
            <br>
            <nav class="level">
              <div class="level-item has-text-centered">
                <button class="button is-link" onclick="toggleData(0)">Points</button>
              </div>
              <div class="level-item has-text-centered">
                <button class="button is-danger" onclick="toggleData(1)">Assists</button>
              </div>
              <div class="level-item has-text-centered">
                <button class="button is-warning" onclick="toggleData(2)">Rebounds</button>
              </div>
            </nav>

          </div>
        </div>
      </div>
    </div>
  </div>

</section>

<script>

  let player_data = JSON.parse(window.localStorage.getItem('player_data'));
  window.localStorage.clear();
  seasons = player_data[0]
  points = player_data[1]

  let borderColor = 
  [
    'rgb(255, 99, 132)',
    'rgb(255, 159, 64)',
    'rgb(255, 205, 86)',
    'rgb(75, 192, 192)',
    'rgb(54, 162, 235)',
    'rgb(153, 102, 255)',
    'rgb(201, 203, 207)'
  ];
  let backgroundColor = 
  [
    'rgba(255, 99, 132, 0.2)',
    'rgba(255, 159, 64, 0.2)',
    'rgba(255, 205, 86, 0.2)',
    'rgba(75, 192, 192, 0.2)',
    'rgba(54, 162, 235, 0.2)',
    'rgba(153, 102, 255, 0.2)',
    'rgba(201, 203, 207, 0.2)'
  ];


  let myChart = document.getElementById("myChart");

  let myGraph = new Chart(myChart, {
    type: "bar", //"line"
    data:{
      labels: seasons,
      datasets:[{
        label: 'Points',
        data: points,
        backgroundColor: backgroundColor,
          borderWidth: 1,
          borderColor: borderColor,
          hoverBorderWidth: 3,
          hoverBorderColor: "#777"
        },
        {
          label: 'Assists',
          data: [7, 10, 5, 12, 20, 23,1,1,1,1,1,1],
          backgroundColor: backgroundColor,
            borderWidth: 1,
            borderColor: borderColor,
            hoverBorderWidth: 3,
            hoverBorderColor: "#777"
        },
        {
            label: 'Rebounds',
            data: [7, 10, 5, 12, 20, 23,1,1,1,1,1,1],
            backgroundColor: backgroundColor,
            borderWidth: 1,
            borderColor: borderColor,
            hoverBorderWidth: 3,
            hoverBorderColor: "#777"
        }
      ]
      },
      options:{
        title:{
          display: true,
          text: "Custom Chart Title"
        }
      }

  });

  function toggleData(index)
  {
    let vis = myGraph.isDatasetVisible(index);
    if(vis === true)
      {
        myGraph.hide(index);
      }
    else if(vis === false)
    {
      myGraph.show(index);
    }
  }  

</script>
{% endblock %}